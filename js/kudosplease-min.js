Kudos=(function(){var b;function a(c){b=this;this.elements=document.querySelectorAll(c.el);this.duration=c.duration;this.timer={};for(var d=0;d<this.elements.length;d++){var e=this.elements[d];localStorage.setItem("kudos:saved:"+d,0);e.setAttribute("data-id",d);b.request(e,"GET");if(this.loadAmount(d)==0){e.setAttribute("data-amount",0);this.timer[d]=-1;if(this.isTouch()){this.on(e,"touchstart",this.enter);this.on(e,"touchend",this.out)}else{this.on(e,"mouseover",this.enter);this.on(e,"mouseout",this.out)}}else{this.finish(e)}}}a.prototype.enter=function(d){var c=this,f=-1;if(!b.hasClass(this,"finish")){b.addClass(c,"active");f=setTimeout(function(){b.removeClass(c,"active");b.finish(c,true)},b.duration);b.timer[c.getAttribute("data-id")]=f}};a.prototype.out=function(c){if(!b.hasClass(this,"finish")){b.removeClass(this,"active");clearTimeout(b.timer[this.getAttribute("data-id")])}};a.prototype.finish=function(c,d){b.addClass(c,"finish");d=d||false;amount=b.loadAmount(parseInt(c.getAttribute("data-id"),10));if(d){++amount;b.request(c,"POST")}c.setAttribute("data-amount",amount);b.save(c.getAttribute("data-id"),amount)};a.prototype.on=function(c,f,d){try{c.addEventListener(f,d,false)}catch(g){c.attachEvent("on"+f,d)}};a.prototype.addClass=function(e,d){d=d.split(",");for(var c=0;c<d.length;c++){if(e.className.indexOf(d[c])==-1){e.className=e.className.trim()+" "+d[c]}}};a.prototype.removeClass=function(e,d){d=d.split(",");for(var c=0;c<d.length;c++){e.className=e.className.replace(d[c],"").trim()}};a.prototype.hasClass=function(g,f){var e=g.className.split(" "),c=false;for(var d=0;d<e.length;d++){if(e[d]==f){c=true}}return c};a.prototype.isTouch=function(){return !!("ontouchstart" in window)||!!("onmsgesturechange" in window)};a.prototype.save=function(d,c){};a.prototype.loadAmount=function(d){var c=b.elements[d].getAttribute("data-amount")||0;return c};a.prototype.request=function(f,d){try{xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){xhr=new XMLHttpRequest()}xhr.onreadystatechange=function(){if(xhr.readyState==4&&xhr.status==200){f.setAttribute("data-amount",xhr.responseText)}};var c="?url="+encodeURIComponent(f.getAttribute("data-url"));xhr.open(d,"http://timpietrusky.koding.com/codepen/kudos/index.php"+c,true);xhr.send()};"".trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return a})();